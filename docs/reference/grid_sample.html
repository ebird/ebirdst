<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Sample observation data on a spacetime grid to reduce spatiotemporal bias."><title>Spatiotemporal grid sampling of observation data — grid_sample • ebirdst</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatiotemporal grid sampling of observation data — grid_sample"><meta property="og:description" content="Sample observation data on a spacetime grid to reduce spatiotemporal bias."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ebirdst</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.2022.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/ebirdst.html">Get Started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/status.html">Introduction to eBird Status Data Products</a>
    <a class="dropdown-item" href="../articles/applications.html">eBird Status Data Products Applications</a>
    <a class="dropdown-item" href="../articles/trends.html">eBird Trends Data Products</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Function Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/product-changelog.html#2022-changelog">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Version History</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ebird/ebirdst/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Spatiotemporal grid sampling of observation data</h1>
      <small class="dont-index">Source: <a href="https://github.com/ebird/ebirdst/blob/HEAD/R/sample.R" class="external-link"><code>R/sample.R</code></a></small>
      <div class="d-none name"><code>grid_sample.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sample observation data on a spacetime grid to reduce spatiotemporal bias.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">grid_sample</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span>, <span class="st">"day_of_year"</span><span class="op">)</span>,</span>
<span>  is_lonlat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3000</span>, <span class="fl">3000</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  jitter_grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sample_size_per_cell <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cell_sample_prop <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  keep_cell_id <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  grid_definition <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">grid_sample_stratified</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span>, <span class="st">"day_of_year"</span><span class="op">)</span>,</span>
<span>  is_lonlat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  unified_grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keep_cell_id <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  by_year <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  case_control <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  obs_column <span class="op">=</span> <span class="st">"obs"</span>,</span>
<span>  sample_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_detection_probability <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  maximum_ss <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  jitter_columns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  jitter_sd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>data frame; observations to sample, including at least the columns
defining the location in space and time. Additional columns can be included
such as features that will later be used in model training.</p></dd>


<dt>coords</dt>
<dd><p>character; names of the spatial and temporal coordinates. By
default the spatial spatial coordinates should be <code>longitude</code> and
<code>latitude</code>, and temporal coordinate should be <code>day_of_year</code>.</p></dd>


<dt>is_lonlat</dt>
<dd><p>logical; if the points are in unprojected, lon-lat
coordinates. In this case, the points will be projected to an equal area
Eckert IV CRS prior to grid assignment.</p></dd>


<dt>res</dt>
<dd><p>numeric; resolution of the spatiotemporal grid in the x, y, and
time dimensions. Unprojected locations are projected to an equal area
coordinate system prior to sampling, and resolution should therefore be
provided in units of meters. The temporal resolution should be in the
native units of the time coordinate in the input data frame, typically it
will be a number of days.</p></dd>


<dt>jitter_grid</dt>
<dd><p>logical; whether to jitter the location of the origin of
the grid to introduce some randomness.</p></dd>


<dt>sample_size_per_cell</dt>
<dd><p>integer; number of observations to sample from
each grid cell.</p></dd>


<dt>cell_sample_prop</dt>
<dd><p>proportion <code>(0-1]</code>; if less than 1, only this
proportion of cells will be randomly selected for sampling.</p></dd>


<dt>keep_cell_id</dt>
<dd><p>logical; whether to retain a unique cell identifier,
stored in column named <code>.cell_id</code>.</p></dd>


<dt>grid_definition</dt>
<dd><p>list defining the spatiotemporal sampling grid as
returned by <code><a href="assign_to_grid.html">assign_to_grid()</a></code> in the form of an attribute of the returned
data frame.</p></dd>


<dt>unified_grid</dt>
<dd><p>logical; whether a single, unified spatiotemporal
sampling grid should be defined and used for all observations in <code>x</code> or a
different grid should be used for each stratum.</p></dd>


<dt>by_year</dt>
<dd><p>logical; whether the sampling should be done by year, i.e.
sampling N observations per grid cell per year, rather than across years,
i.e. N observations per grid cell regardless of year. If using sampling by
year, the input data frame <code>x</code> must have a <code>year</code> column.</p></dd>


<dt>case_control</dt>
<dd><p>logical; whether to apply case control sampling whereby
presence and absence are sampled independently.</p></dd>


<dt>obs_column</dt>
<dd><p>character; if <code>case_control = TRUE</code>, this is the name of
the column in <code>x</code> that defines detection (<code>obs_column &gt; 0</code>) and
non-detection (<code>obs_column == 0</code>).</p></dd>


<dt>sample_by</dt>
<dd><p>character; additional columns in <code>x</code> to stratify sampling
by. For example, if a landscape has many small islands (defined by an
<code>island</code> variable) and we wish to sample from each independently, use
<code>sample_by = "island"</code>.</p></dd>


<dt>min_detection_probability</dt>
<dd><p>proportion <code>[0-1)</code>; the minimum detection
probability in the final dataset. If <code>case_control = TRUE</code>, and the
proportion of detections in the grid sampled dataset is below this level,
then additional detections will be added via grid sampling the detections
from the input dataset until at least this proportion of detections appears
in the final dataset. This will typically result in duplication of some
observations in the final dataset. To turn this off this feature use
<code>min_detection_probability = 0</code>.</p></dd>


<dt>maximum_ss</dt>
<dd><p>integer; the maximum sample size in the final dataset. If
the grid sampling yields more than this number of observations,
<code>maximum_ss</code> observations will be selected randomly from the full set. Note
that this subsampling will be performed in such a way that all levels of
each strata will have at least one observation within the final dataset,
and therefore it is not truly randomly sampling.</p></dd>


<dt>jitter_columns</dt>
<dd><p>character; if detections are oversampled to achieve the
minimum detection probability, some observations will be duplicated, and it
can be desirable to slightly "jitter" the values of model training features
for these duplicated observations. This argument defines the column names
in <code>x</code> that will be jittered.</p></dd>


<dt>jitter_sd</dt>
<dd><p>numeric; strength of the jittering in units of standard
deviations, see <code>jitter_columns</code>.</p></dd>


<dt>...</dt>
<dd><p>additional arguments defining the spatiotemporal grid; passed to
<code>grid_sample()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data frame of the spatiotemporally sampled data.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>grid_sample_stratified()</code> performs stratified case control sampling,
independently sampling from strata defined by, for example, year and
detection/non-detection. Within each stratum, <code>grid_sample()</code> is used to
sample the observations on a spatiotemporal grid. In addition, if case
control sampling is turned on, the detections are oversampled to increase the
frequecy of detections in the dataset.</p>
<p>The sampling grid is defined, and assignment of locations to cells occurs, in
<code><a href="assign_to_grid.html">assign_to_grid()</a></code>. Consult the help for that function for further details on
how the grid is generated and locations are assigned. Note that by providing
2-element vectors to both <code>coords</code> and <code>res</code> the time component of the grid
can be ignored and spatial-only subsampling is performed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate some example observations</span></span></span>
<span class="r-in"><span><span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span></span>
<span class="r-in"><span><span class="va">checklists</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_obs</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_obs</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         day_of_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">28</span>, <span class="va">n_obs</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         year <span class="op">=</span> <span class="cn">NA_integer_</span>,</span></span>
<span class="r-in"><span>                         obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n_obs</span>, lambda <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         forest_cover <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         island <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># add a year column, giving more data to recent years</span></span></span>
<span class="r-in"><span><span class="va">checklists</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2016</span>, <span class="fl">2020</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">n_obs</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                          prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># create several rare islands</span></span></span>
<span class="r-in"><span><span class="va">checklists</span><span class="op">$</span><span class="va">island</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">checklists</span><span class="op">)</span>, <span class="fl">9</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># basic spatiotemporal grid sampling</span></span></span>
<span class="r-in"><span><span class="va">sampled</span> <span class="op">&lt;-</span> <span class="fu">grid_sample</span><span class="op">(</span><span class="va">checklists</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot original data and grid sampled data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">checklists</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">0.3</span>, col <span class="op">=</span> <span class="st">"#00000033"</span>,</span></span>
<span class="r-in"><span>     axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">sampled</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>       pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">0.3</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="grid_sample-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># case control sampling stratified by year and island</span></span></span>
<span class="r-in"><span><span class="co"># return a maximum of 1000 checklists</span></span></span>
<span class="r-in"><span><span class="va">sampled_cc</span> <span class="op">&lt;-</span> <span class="fu">grid_sample_stratified</span><span class="op">(</span><span class="va">checklists</span>, sample_by <span class="op">=</span> <span class="st">"island"</span>,</span></span>
<span class="r-in"><span>                                     maximum_ss <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># case control sampling increases the prevalence of detections</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">checklists</span><span class="op">$</span><span class="va">obs</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1005</span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sampled</span><span class="op">$</span><span class="va">obs</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1072363</span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sampled_cc</span><span class="op">$</span><span class="va">obs</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.171627</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># stratifying by island ensures all levels are retained, even rare ones</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">checklists</span><span class="op">$</span><span class="va">island</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    1    2    3    4    5    6    7    8    9   10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9505  486    1    1    1    1    1    1    1    1    1 </span>
<span class="r-in"><span><span class="co"># normal grid sampling loses rare island levels</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">sampled</span><span class="op">$</span><span class="va">island</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    1    3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1094   52    1 </span>
<span class="r-in"><span><span class="co"># stratified grid sampling retain at least one observation from each level</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">sampled_cc</span><span class="op">$</span><span class="va">island</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0   1   2   3   4   5   6   7   8   9  10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 912  87   1   1   1   1   1   1   1   1   1 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://strimas.com" class="external-link">Matthew Strimas-Mackey</a>, Shawn Ligocki, Tom Auer, Daniel Fink.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

